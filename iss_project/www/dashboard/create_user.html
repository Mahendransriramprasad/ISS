{% block head_include %}
<script src="https://cdn.tailwindcss.com"></script>

<!-- Heroicons -->
<script src="https://unpkg.com/heroicons@2.1.1/dist/heroicons.js"></script>
{% endblock %}

<div class="min-h-screen bg-gray-100 flex items-center justify-center p-6">

  <div class="bg-white rounded-2xl shadow-lg p-8 w-full max-w-lg border border-gray-100">
    
    <!-- Title -->
    <h1 class="text-3xl font-bold text-gray-800 mb-8 flex items-center gap-3">
      <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor">
        <use href="#user-plus" />
      </svg>
      Create User (HR & Finance)
    </h1>

    <!-- Full Name -->
    <div class="mb-5">
      <label class="block mb-1 font-medium text-gray-700">Full Name</label>
      <div class="relative">
        <input id="full_name"
          class="p-3 pl-10 w-full border rounded-xl focus:ring-2 focus:ring-blue-400 focus:outline-none"
          placeholder="John Doe">
        <svg class="w-5 h-5 text-gray-400 absolute left-3 top-3.5" fill="none" stroke="currentColor">
          <use href="#user" />
        </svg>
      </div>
    </div>

    <!-- Email -->
    <div class="mb-5">
      <label class="block mb-1 font-medium text-gray-700">Email</label>
      <div class="relative">
        <input id="email"
          class="p-3 pl-10 w-full border rounded-xl focus:ring-2 focus:ring-blue-400 focus:outline-none"
          placeholder="user@example.com">
        <svg class="w-5 h-5 text-gray-400 absolute left-3 top-3.5" fill="none" stroke="currentColor">
          <use href="#mail" />
        </svg>
      </div>
    </div>

    <!-- Role Type -->
    <div class="mb-6">
      <label class="block mb-1 font-medium text-gray-700">Role Type</label>
      <div class="relative">
        <select id="role_type"
          class="p-3 pl-10 w-full border rounded-xl focus:ring-2 focus:ring-blue-400 focus:outline-none bg-white">
          <option value="Developer">Developer</option>
          <option value="Project Manager">Project Manager</option>
          <option value="HR Finance">HR & Finance</option>
          <option value="Management">Management</option>
        </select>
        <svg class="w-5 h-5 text-gray-400 absolute left-3 top-3.5" fill="none" stroke="currentColor">
          <use href="#briefcase" />
        </svg>
      </div>
    </div>

    <!-- Button -->
    <button onclick="createUser()"
      class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-xl font-semibold shadow-md transition flex items-center justify-center gap-2">
      <svg class="w-5 h-5" fill="none" stroke="currentColor">
        <use href="#plus" />
      </svg>
      Create User
    </button>

    <!-- Response -->
    <p id="response" class="mt-5 text-center font-medium"></p>

  </div>
</div>

<!-- Heroicons symbols -->
<svg style="display:none;">

  <symbol id="user-plus" viewBox="0 0 24 24" stroke-width="1.8">
    <circle cx="12" cy="8" r="4" />
    <path d="M6 20v-2a4 4 0 014-4h0a4 4 0 014 4v2" />
    <path d="M19 8v6" />
    <path d="M22 11h-6" />
  </symbol>

  <symbol id="user" viewBox="0 0 24 24" stroke-width="1.8">
    <circle cx="12" cy="8" r="4" />
    <path d="M6 20v-2a4 4 0 014-4h0a4 4 0 014 4v2" />
  </symbol>

  <symbol id="mail" viewBox="0 0 24 24" stroke-width="1.8">
    <path d="M3 5h18v14H3z" />
    <path d="M3 7l9 6 9-6" />
  </symbol>

  <symbol id="plus" viewBox="0 0 24 24" stroke-width="1.8">
    <path d="M12 5v14" />
    <path d="M5 12h14" />
  </symbol>

  <symbol id="briefcase" viewBox="0 0 24 24" stroke-width="1.8">
    <path d="M9 6V5a2 2 0 012-2h2a2 2 0 012 2v1" />
    <path d="M3 10a2 2 0 012-2h14a2 2 0 012 2v7a2 2 0 01-2 2H5a2 2 0 01-2-2v-7z" />
  </symbol>

</svg>

<script>
async function createUser() {
  const full_name = document.getElementById("full_name").value;
  const email = document.getElementById("email").value;
  const role_type = document.getElementById("role_type").value;

  const res = await fetch("/api/method/iss_project.www.api.hr_user_api.create_portal_user", {
    method: "POST",
    body: JSON.stringify({ full_name, email, role_type }),
    headers: { "Content-Type": "application/json" }
  });

  const data = await res.json();
  const resp = document.getElementById("response");

  if (data.message.ok) {
    resp.innerText = data.message.message;
    resp.className = "mt-4 text-green-600 font-semibold";
  } else {
    resp.innerText = "Error creating user.";
    resp.className = "mt-4 text-red-600 font-semibold";
  }
}
</script>
